!function(e){var t={};function a(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=22)}({22:function(e,t,a){"use strict";a.r(t);var i={handleDateTimePicker(){if(void 0===window.kaliDateTime)return;const e=[],t=window.kaliDateTime.moment,a=window.kaliDateTime.flatpickr,i=!(!window.hasOwnProperty("FlatPickrSelectedLanguage")||!a.l10ns.hasOwnProperty(FlatPickrSelectedLanguage.lang))&&FlatPickrSelectedLanguage.lang,n=e=>{let t=[],a=[];return e.map(e=>{let i=e.trim();if(""!==i)if(["sundays","mondays","tuesdays","wednesdays","thursdays","fridays","saturdays"].includes(i))a.push((e=>["sundays","mondays","tuesdays","wednesdays","thursdays","fridays","saturdays"].indexOf(e))(i));else if(i.includes("[")&&i.includes("]")){i=i.slice(1,-1);let e=i.split(":");if(e.length<2)return;t.push({from:e[0],to:e[1]})}else t.push(i)}),a.length&&t.push(e=>a.includes(e.getDay())),t};[...this.formElements].forEach(r=>{if(r.classList.contains("kaliforms-date-time-picker")){let s={disableMobile:!0,inline:r.hasAttribute("inline"),enableTime:r.hasAttribute("showtime"),minTime:r.getAttribute("data-mintime"),maxTime:r.getAttribute("data-maxtime"),minDate:r.getAttribute("data-mindate"),maxDate:r.getAttribute("data-maxdate"),dateFormat:r.getAttribute("data-dateformat"),minDateToday:r.hasAttribute("mindatetoday"),disable:!!window.hasOwnProperty("KaliFormsDisabledDates"+r.getAttribute("data-internal-id"))||null};s.inline||(s.wrap=!0),i&&(s.locale=i),r.hasAttribute("data-weekdaystarts")&&parseInt(r.getAttribute("data-weekdaystarts"))<7&&(void 0===s.locale?s.locale={firstDayOfWeek:parseInt(r.getAttribute("data-weekdaystarts"))}:a.l10ns.hasOwnProperty(i)&&(a.l10ns[i].firstDayOfWeek=parseInt(r.getAttribute("data-weekdaystarts")))),s.dateFormat=null===s.dateFormat?s.enableTime?"d-m-Y H:i":"d-m-Y":s.dateFormat;let o={};for(let e in s)if(null!==s[e]&&(o[e]=s[e],"minDate"!==e&&"maxDate"!==e||(o[e]=t(s[e],"DD-MM-YYYY").toDate()),"disable"===e)){if("kf-select-field"===r.getAttribute("data-codependancyfield")){o[e]=Object.values(window["KaliFormsDisabledDates"+r.getAttribute("data-internal-id")]);continue}let t=[],a=window["KaliFormsDisabledDates"+r.getAttribute("data-internal-id")];t=[...a.global];let i=document.querySelector('[data-internal-id="'+r.getAttribute("data-codependancyfield")+'"');null!==i&&(a.hasOwnProperty(i.value)&&(t=[...a[i.value]]),i.addEventListener("change",e=>{let t=[];t=[...window["KaliFormsDisabledDates"+r.getAttribute("data-internal-id")].global],a.hasOwnProperty(e.target.value)&&(t=[...t,...a[e.target.value]]),d.set("disable",t)})),o[e]=n(t)}o.minDate=s.minDateToday?"today":o.minDate;let l=o.wrap?r.parentNode:r;const d=a(l,o);if(e[r.getAttribute("data-internal-id")]=d,r.hasAttribute("data-mindatedependency")){let t=document.querySelector('[data-internal-id="'+r.getAttribute("data-mindatedependency")+'"]');e[r.getAttribute("data-internal-id")].dependency=o.wrap?t.parentNode:t}}});for(let t in e){let a=e[t];a.hasOwnProperty("dependency")&&a.dependency._flatpickr.config.onChange.push(e=>{if(!e.length)return void a.clear();let t=a.input.getAttribute("mindatedependencyoffset"),i=new Date(e);void 0!==t&&(t=parseInt(t)<0?-1*parseInt(t):parseInt(t),i.setDate(i.getDate()+parseInt(t))),a.clear(),a.set("minDate",i)})}}};const n=window.kaliChoices;var r={handleChoices(){void 0!==n&&[...this.formElements].map(e=>{if(e.classList.contains("kaliforms-choices")){let t=!(e.hasAttribute("maxitemcount")&&parseFloat(e.getAttribute("maxitemcount"))>1),a=e.hasAttribute("multipleseparator")?e.getAttribute("multipleseparator"):",",i=e.hasAttribute("placeholder")?e.getAttribute("placeholder"):"",r={maxItemCount:t?1:e.getAttribute("maxitemcount"),removeItemButton:!0,delimiter:a,shouldSortItems:!0,sorter:(e,t)=>{}};""!==i&&(r.placeholderValue=i);const s=new n(e,r);if(s.triggerError=function(){let e=this.passedElement.element;e.parentNode.classList.add("kali-error");const t=a=>{""!==a.target.value&&(e.parentNode.classList.remove("kali-error"),e.removeEventListener("change",t,!0))};e.addEventListener("change",t,!0)},this.choices.push(s),e.hasAttribute("populatefromapi")&&""!==e.getAttribute("populatefromapi")){const t={value:"value",label:"label"};if(e.hasAttribute("data-dataformat")){let a=e.getAttribute("data-dataformat").split(",");t.value=a[0],t.label=a[1]}s.setChoices(async()=>{try{const a=await fetch(e.getAttribute("populatefromapi")),i=[];return(await a.json()).map(e=>{if(e.hasOwnProperty(t.value)&&e.hasOwnProperty(t.label))i.push({value:e[t.value],label:e[t.label]});else{console.warn("Response from API is not in the correct format");let t="";for(var a in e)t+=a+",";console.warn("Available properties are: "+t)}}),i}catch(e){console.error(e)}})}}})}};const{__:s}=wp.i18n;class o{constructor(e){this.context=e,this.attachEvents(),this.index=0}_pageChange(e){const t=e.target.getAttribute("data-direction"),a=e.target.hasAttribute("validateonnext");let i=e.target.parentNode.parentNode.parentNode;i.classList.contains("kaliforms-page")||(i=i.parentNode.parentNode);const n=0!==parseFloat(i.getAttribute("data-index"))&&this.pages[parseFloat(i.getAttribute("data-index"))-1],r=parseFloat(i.getAttribute("data-index"))!==this.pages.length-1&&this.pages[parseFloat(i.getAttribute("data-index"))+1];if("next"===t&&!r)return;if("prev"===t&&!n)return;if("next"===t&&a&&!this._validatePage(i))return;"next"===t?i.classList.add("kaliforms-fade-out-left"):i.classList.add("kaliforms-fade-out-right");let s=this.whichAnimationEvent();const o=()=>{let e;switch(t){case"prev":n.classList.add("active","kaliforms-fade-in-left"),i.classList.remove("kaliforms-fade-out-right","kaliforms-fade-out-left","active"),this.index=n.getAttribute("data-index"),this.moveIndicator("prev"),e=()=>{n.classList.remove("kaliforms-fade-in-right","kaliforms-fade-in-left","kaliforms-fade-out-left","kaliforms-fade-out-right"),this.context.form.removeEventListener(s,e)},this.context.form.addEventListener(s,e);break;case"next":r.classList.add("kaliforms-fade-in-right","active"),i.classList.remove("kaliforms-fade-out-left","kaliforms-fade-out-right","active"),this.index=r.getAttribute("data-index"),this.moveIndicator("next"),e=()=>{r.classList.remove("kaliforms-fade-in-right","kaliforms-fade-in-left","kaliforms-fade-out-left","kaliforms-fade-out-right"),this.context.form.removeEventListener(s,e)},this.context.form.addEventListener(s,e);break;default:console.warn("something went wrong")}this.context.form.dispatchEvent(new CustomEvent("kaliFormPageChanged",{detail:this})),this.context.form.removeEventListener(s,o),this.context.errorMessage=""};s&&this.context.form.addEventListener(s,o)}_getPage(e){return e.closest(".kaliforms-page")}_changePage(e,t){let a,i=parseInt(e.getAttribute("data-index"))-parseInt(t.getAttribute("data-index"))>0?"prev":"next",n=this.whichAnimationEvent();switch(i){case"prev":t.classList.add("active","kaliforms-fade-in-left"),e.classList.remove("kaliforms-fade-out-right","kaliforms-fade-out-left","active"),this.index=t.getAttribute("data-index"),this.moveIndicator("prev"),a=()=>{t.classList.remove("kaliforms-fade-in-right","kaliforms-fade-in-left","kaliforms-fade-out-left","kaliforms-fade-out-right"),this.context.form.removeEventListener(n,a)},this.context.form.dispatchEvent(new CustomEvent("kaliFormPageChanged",{detail:this})),this.context.form.addEventListener(n,a)}}attachEvents(){document.addEventListener("kaliformProcessError",e=>{let t=e.detail,a=!1,i=null,n=null;for(let e in t._formFieldHTMLMap){if(a&&null!==i)break;t._formFieldHTMLMap[e].classList.contains("kali-error")&&(a=!0,i=t._formFieldHTMLMap[e])}null!==i&&(n=this._getPage(i));let r=[...document.getElementsByClassName("kaliforms-page active")][0];n&&this._changePage(r,n)}),[...this.context.form.querySelectorAll(".kaliforms-pagebreak__button")].forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),this._pageChange(e)})}),this.context.form.addEventListener("kaliFormChangePage",e=>{let t=[...document.getElementsByClassName("kaliforms-page active")][0],{page:a}=e.detail;t&&a&&this._changePage(t,a)}),this.context.form.addEventListener("kaliFormPageChanged",e=>{this.context.form.scrollIntoView({behavior:"smooth",block:"start"})}),this.context.form.addEventListener("kaliResetForm",()=>{let e=[...document.getElementsByClassName("kaliforms-page active")][0],t=[...document.getElementsByClassName("kaliforms-page")][0];e.classList.add("kaliforms-fade-out-right");let a=this.whichAnimationEvent();a&&this.context.form.addEventListener(a,()=>{let i;t.classList.add("active","kaliforms-fade-in-left"),e.classList.remove("kaliforms-fade-out-right","kaliforms-fade-out-left","active"),this.index=0,this.moveIndicator("prev"),i=()=>{t.classList.remove("kaliforms-fade-in-right","kaliforms-fade-in-left","kaliforms-fade-out-left","kaliforms-fade-out-right"),this.context.form.removeEventListener(a,i)},this.context.form.dispatchEvent(new CustomEvent("kaliFormPageChanged",{detail:this})),this.context.form.addEventListener(a,i)})})}wrapInPages(){const e=[...this.context.form.querySelectorAll(".kaliforms-pagebreak")];this.pages=[];let t=!1,a=[];for(let t=e.length;t>=0;t--)document.getElementById("kaliforms-global-error-message-".concat(this.context.formId)).insertAdjacentHTML("afterend",'<div class="kaliforms-page '.concat(0===t?"active":"",'" data-index="').concat(t,'"></div>'));if(e.map((e,i)=>{e.hasAttribute("progressbar")&&(t=!0),a.push(e.hasAttribute("data-page-title")?e.getAttribute("data-page-title"):"Step - ".concat(i+1))}),window.hasOwnProperty("KaliFormsPageBreakCompleteLabel"+this.context.formId)){let e="KaliFormsPageBreakCompleteLabel"+this.context.formId;a.push(window[e])}else a.push("Complete");let i=0,n=this.context.form.querySelector('.kaliforms-page[data-index="0"]');this.pages.push(n),[...this.context.form.querySelectorAll(".kali-form-field-row")].map(e=>{n.appendChild(e),[...e.querySelectorAll(".kaliforms-pagebreak")].length&&(i++,n=this.context.form.querySelector('.kaliforms-page[data-index="'.concat(i,'"]')),this.pages.push(n))}),this.addBackButtonInSubmit(),e[0].querySelector('button[data-direction="prev"').style.display="none",t&&this.createProgressBar(a),this.context.form.style.opacity=1}createProgressBar(e){document.getElementById("kaliforms-global-error-message-".concat(this.context.formId)).insertAdjacentHTML("afterend",'<div class="kaliforms-form-progress row text-center" id="kaliforms-form-progress-'.concat(this.context.formId,'"></div>'));const t=document.getElementById("kaliforms-form-progress-".concat(this.context.formId));e.map((e,a)=>{t.insertAdjacentHTML("beforeend",'<div class="col"><span class="visible-lg">'.concat(e,'</span><span class="visible-sm">').concat(a+1,"</span></div>"))}),t.insertAdjacentHTML("beforeend",'<span class="kaliforms-form-progress__indicator" id="kaliforms-form-progress-indicator-'.concat(this.context.formId,'"></span>'));const a=document.getElementById("kaliforms-form-progress-indicator-".concat(this.context.formId)),i=t.getBoundingClientRect().width-30,n=this.getElementWidth(t);this.progressBar={container:t,indicator:a,totalWidth:i,elementWidth:n,index:0},this.progressBar.indicator.style.bottom="".concat(this.progressBar.container.getBoundingClientRect().height/2,"px"),this.progressBar.indicator.style.right="".concat(n*(e.length-1),"px")}moveIndicator(e){if(void 0===this.progressBar)return;let t=this.progressBar.index,a=this.index,i=0;switch(e){case"prev":this.progressBar.index=this.index,i=t-a,this.progressBar.indicator.style.right="".concat(parseInt(this.progressBar.indicator.style.right.replace("px",""))+this.progressBar.elementWidth*i,"px");break;case"next":this.progressBar.index=this.index,i=a-t;let e=parseInt(this.progressBar.indicator.style.right.replace("px",""))-this.progressBar.elementWidth*i;this.progressBar.indicator.style.right=e<15?"15px":"".concat(e,"px")}}_move(e){}getElementWidth(e){return[...e.querySelectorAll(".col")][0].getBoundingClientRect().width}addBackButtonInSubmit(){const e=this.pages[this.pages.length-1].querySelector('input[type="submit"]');if(null===e)return;let t=[...this.context.form.querySelectorAll(".kaliforms-pagebreak__button")];if(t=t.length>0&&t[0],!t)return;const a=t.cloneNode(!0);e.insertAdjacentHTML("beforebegin",'<div class="row"><div class="col" id="back-button-'.concat(this.context.formId,'-container"></div><div class="col text-right" id="submit-button-').concat(this.context.formId,'-container"></div></div>')),document.getElementById("back-button-".concat(this.context.formId,"-container")).appendChild(a),document.getElementById("submit-button-".concat(this.context.formId,"-container")).appendChild(e),a.addEventListener("click",e=>{e.preventDefault(),this._pageChange(e)})}_validatePage(e){if(!this._checkboxValidation())return console.log("x"),!1;if(!this._uploadValidation())return console.log("y"),!1;let t=!0;return[...this.context.formElements].reverse().forEach(e=>{e.offsetHeight>0&&(e.checkValidity()||(e.reportValidity(),t=!1,console.log(e),console.log(t)))}),t}whichAnimationEvent(){let e,t=document.createElement("fakeelement"),a={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in a)if(void 0!==t.style[e])return a[e]}_uploadValidation(){if(0===this.context.uploadFields.length)return!0;let e=[];return this.context.uploadFields.forEach(t=>{if("true"===t.getAttribute("data-was-required")&&""===t.value){const a=t.getAttribute("data-internal-id");let i;if(Object.keys(this.context.conditions).forEach(e=>{const t=this.context.conditions[e];t.hide.forEach(t=>{t.field===a&&(i={...t,key:e,isShow:!1})}),t.show.forEach(t=>{t.field===a&&(i={...t,key:e,isShow:!0})})}),i){this.context._getFormData();const t=this.context._formData,n=this.context.checkCondition(i.operator,i.value,t[i.key]||""),r=this.context.uploadFieldsPond[a];n&&i.isShow&&0===r.getFiles().length&&(e.push(!1),this.context.errorMessage=s("Some files were not uploaded","kaliforms"),this.context.throwError())}else{const t=this.context.form.querySelector('[data-internal-id="'.concat(a,'"]')).parentElement.parentElement.parentElement,i=(null==t?void 0:t.getAttribute("data-index"))||0;if(parseInt(this.index)===parseInt(i)){0===this.context.uploadFieldsPond[a].getFiles().length&&(e.push(!1),this.context.errorMessage=s("Some files were not uploaded","kaliforms"),this.context.throwError())}}}}),0===e.filter(e=>!1===e).length}onThisPage(e){const t=e.parentElement.parentElement.parentElement.parentElement,a=(null==t?void 0:t.getAttribute("data-index"))||0;return parseInt(this.index)===parseInt(a)}_checkboxValidation(){let e=!0;if(Object.keys(this.context.checkboxes).length){for(let e in this.context.checkboxes){let t=this.context.checkboxes[e];t.required&&(this.onThisPage(t.fields[0])&&t.fields.forEach(e=>t.valid=!!t.valid||e.checked))}for(let t in this.context.checkboxes){let a=this.context.checkboxes[t];this.onThisPage(a.fields[0])&&(a.required&&!a.valid&&a.fields.forEach((e,t)=>{null!==e.offsetParent||(a.valid=!0)}),a.required&&!a.valid&&(e=!1,a.fields.forEach((e,t)=>{0===t&&(e.setAttribute("required","true"),this.context.form.reportValidity(),setTimeout(()=>e.removeAttribute("required"),1e3))})))}}return e}}var l={handlePageBreaks(){if(![...this.form.querySelectorAll(".kaliforms-pagebreak")].length)return;new o(this).wrapInPages()}},d=a(4),c=a.n(d);class h{set conditions(e){let t={},a={},i={},n={};e.map(e=>{i[e.field]=[],n[e.field]=this._setParentNodeInMap(e.field),n[e.conditioner]=this._setParentNodeInMap(e.conditioner),t[e.conditioner]={hide:[],show:[]},a[e.field]={operator:e.operator,value:(e.operator,[])}}),e.map(e=>{0!==e.conditioner.trim().length&&(i[e.field].push(e.conditioner),a.hasOwnProperty(e.field)&&"or"===e.operator&&a[e.field].value.push(e.value))}),e.map(e=>{"equal"!==a[e.field].operator&&"different"!==a[e.field].operator||(a[e.field].value=e.value),"hide"===e.state?t[e.conditioner].hide.push({field:e.field,...a[e.field]}):t[e.conditioner].show.push({field:e.field,...a[e.field]})}),this.parentNodes=n,this.coDependents=i;let r={};for(let e in t)""!==e&&""!==t[e]&&(r[e]=t[e]);this._conditions=r}set coDependents(e){let t={};for(let a in e)""!==a&&0!==e[a].length&&(t[a]=e[a]);this._coDependents=t}get coDependents(){return this._coDependents}set parentNodes(e){let t={};for(let a in e)""!==a&&""!==e[a]&&(t[a]=e[a]);this._parentNodes=t}get parentNodes(){return this._parentNodes}get conditions(){return this._conditions}constructor(e,t){this.formProcessor=e,this.initialConds=t,this.conditions=t,this.eventBus=c.a,this.requiredFields(),this.formProcessor.conditionalFieldsLoaded=!1,this.formProcessor.conditionalFields=Object.keys(this.conditions).length>0,this.formProcessor.conditions=this.conditions,this.formProcessor.checkCondition=this.checkCondition,this.formProcessor._checkValueEqual=this._checkValueEqual,this.formProcessor._checkValueStringInOr=this._checkValueStringInOr,this.formProcessor._checkValueArrayInOr=this._checkValueArrayInOr,this.renderInitialLoad().then(()=>{this.formProcessor.conditionalFieldsLoaded=!0,this.subscribeFormElements(),this.attachEvents()})}getEl(e){return document.querySelector('[data-internal-id="'.concat(e,'"]'))}getEls(e){return document.querySelectorAll('[data-internal-id="'.concat(e,'"]'))}_getParentNode(e){let t=this.getEl(e.field);if(null!==t)return t.closest('div[class^="col-"]')}_setParentNodeInMap(e){let t=this.getEl(e);return null!==t&&{el:t,parentNode:t.closest('div[class^="col-"]'),type:t.getAttribute("type"),identifier:e}}_getValueFromUnknown(e,t){let a="checkbox"===t||"choices"===t?[]:"";switch(t){case"radio":a=this._getCheckedRadioItem(e);break;case"checkbox":a=this._getCheckedBoxes(e)}return a}_getValueFromChoices(e){let t=e.hasAttribute("multiple"),a=t?[]:"";return[...e.querySelectorAll("option")].map(e=>{t?a.push(e.value):a=e.value}),a}_getCheckedRadioItem(e){let t=e.length>1?[...e]:[...document.getElementsByName(e.getAttribute("name"))];return t.length?void 0===t.find(e=>e.checked)?"":t.find(e=>e.checked).value:""}_getCheckedBoxes(e){let t=e.length>1?[...e]:[...document.getElementsByName(this._getNameFromUnknownType(e))];if(!t.length)return[];if(void 0===t.find(e=>e.checked))return[];let a=[];return t.map(e=>{e.checked&&(""===e.value&&e.hasAttribute("data-saved-value")&&(e.value=e.getAttribute("data-saved-value")),a.push(e.value))}),a}_getNameFromUnknownType(e){return NodeList.prototype.isPrototypeOf(e)?(e=[...e])[0].getAttribute("name"):e.getAttribute("name")}whichAnimationEvent(){let e,t=document.createElement("fakeelement"),a={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in a)if(void 0!==t.style[e])return a[e]}sleep(e){return new Promise(t=>setTimeout(t,e))}checkCondition(e,t,a){let i=!1;switch(e){case"equal":i=this._checkValueEqual(t,a);break;case"different":i=!this._checkValueEqual(t,a);break;case"or":i="string"==typeof a?this._checkValueStringInOr(t,a):this._checkValueArrayInOr(t,a)}return i}_checkValueEqual(e,t){return"string"==typeof e&&"string"==typeof t?e===t:"string"==typeof e&&"string"!=typeof t?!(t.length>1)&&t[0]===e:void 0}_checkValueStringInOr(e,t){return e.indexOf(t)>-1}_checkValueArrayInOr(e,t){return t.some(t=>e.indexOf(t)>=0)}checkDependencies(e,t,a){let i=!1;if(this.coDependents.hasOwnProperty(e.field)&&this.coDependents[e.field].length>1){i=!0;let n=[];this.coDependents[e.field].map(i=>{i!==t&&this.conditions[i][a].map(t=>{t.field===e.field&&n.push({...t,dep:i})})});let r=[];n.map((e,t)=>{let a=this.getEl(e.dep),i=a.getAttribute("type"),n="radio"!==i&&"checkbox"!==i?a.value:this._getValueFromUnknown(a,i);this.checkCondition(e.operator,e.value,n)&&r.push(t)}),r.length===n.length&&(i=!1)}return i}subscribeFormElements(){this.eventBus.subscribe("hide",e=>this.hide(e)),this.eventBus.subscribe("show",e=>this.show(e))}hide(e){if(!this.parentNodes[e])return;const t=this.whichAnimationEvent(),a=this.parentNodes[e].parentNode;a.classList.add("kaliforms-fade-out","kali-hidden-condition");const i=()=>{if(a.style.display="none",a.classList.remove("kaliforms-fade-out"),["button","submit"].includes(this.parentNodes[e].type)||(this.parentNodes[e].el.value=""),["checkbox","radio"].includes(this.parentNodes[e].type)&&[...this.getEls(e)].map(e=>{e.checked=!1,e.dispatchEvent(new Event("change",{cancelable:!0}))}),this.requiredFieldsArr.includes(e)){if("radio"===this.parentNodes[e].type)return void[...this.getEls(e)].map(e=>e.removeAttribute("required"));this.parentNodes[e].el.removeAttribute("required")}this.formProcessor.form.removeEventListener(t,i)};t&&this.formProcessor.form.addEventListener(t,i)}show(e){if(!this.parentNodes[e])return;const t=this.whichAnimationEvent(),a=this.parentNodes[e].parentNode;a.style.display="initial",a.classList.add("kaliforms-fade-in"),a.classList.remove("kali-hidden-condition");const i=()=>{if(a.style.display="",a.classList.remove("kaliforms-fade-in"),this.requiredFieldsArr.includes(e)){if("radio"===this.parentNodes[e].type)return void[...this.getEls(e)].map(e=>e.setAttribute("required",!0));this.parentNodes[e].el.setAttribute("required",!0)}"paypal"!==this.parentNodes[e].type||this.formProcessor.paypalObject.hasOwnProperty("resolved")||(this.formProcessor.paypalObject=this.formProcessor.paypalObject.render("#"+this.parentNodes[e].el.getAttribute("id"))),this.formProcessor.form.removeEventListener(t,i)};t&&this.formProcessor.form.addEventListener(t,i)}attachEvents(){Object.keys(this.conditions).map(e=>{if(null!==this.parentNodes[e].el)if(["radio","checkbox"].includes(this.parentNodes[e].type)){let t=document.getElementsByName(this.parentNodes[e].el.getAttribute("name"));[...t].map(a=>a.addEventListener("change",a=>this.conditionChanged(a,e,t)))}else this.parentNodes[e].el.addEventListener("change",t=>this.conditionChanged(t,e))})}conditionChanged(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null!==a?this._getValueFromUnknown(a,a[0].getAttribute("type")):e.target.value;"choices"===e.target.getAttribute("type")&&(i=this._getValueFromChoices(e.target));let n=[];this.conditions[t].hide.map(e=>{let a={state:"hide",internalId:e.field};this.checkCondition(e.operator,e.value,i)&&!this.checkDependencies(e,t,"hide")?n.push(a):n.push({...a,state:"show"})}),this.conditions[t].show.map(e=>{let a={state:"show",internalId:e.field};this.checkCondition(e.operator,e.value,i)&&!this.checkDependencies(e,t,"show")?n.push(a):n.push({...a,state:"hide"})}),n=this.eventBus.arrayUnique(n),n.map(e=>this.eventBus.publish(e.state,e.internalId))}async renderInitialLoad(){await this._render()}async _render(){let e=[];return Object.keys(this.conditions).map(t=>{this.conditions[t].hide.map(async a=>{null!==this.parentNodes[t].el&&e.push(this._renderInitialEffect(t,a,!0))}),this.conditions[t].show.map(async a=>{null!==this.parentNodes[t].el&&e.push(this._renderInitialEffect(t,a,!1))})}),await Promise.all(e)}async _renderInitialEffect(e,t,a){const i=this.parentNodes[e].type,n="radio"!==i&&"checkbox"!==i?this.parentNodes[e].el.value:this._getValueFromUnknown(this.parentNodes[e].el,i);if(this.parentNodes[t.field])switch(t.operator){case"equal":if(this.checkCondition("equal",t.value,n)===a)return await this._affectItem(t);break;case"different":if(this.checkCondition("different",t.value,n)===a)return await this._affectItem(t);break;case"or":if(this.checkCondition("or",t.value,n)===a)return await this._affectItem(t)}}async _affectItem(e){if(this.parentNodes[e.field].parentNode.style.display="none",this.parentNodes[e.field].parentNode.classList.add("kali-hidden-condition"),this.requiredFieldsArr.includes(e.field)){if("radio"===this.parentNodes[e.field].type)return void[...this.getEls(e.field)].map(e=>e.removeAttribute("required"));this.parentNodes[e.field].el.removeAttribute("required")}}async loadPayPal(){for(;void 0===this.formProcessor.paypalObject||!this.formProcessor.paypalObject.resolved;)await this.sleep(50)}requiredFields(){let e=[],t=[];[...this.formProcessor.formElements].forEach(a=>{null!==a.getAttribute("required")&&e.push(a.getAttribute("data-internal-id")),"true"===a.getAttribute("data-was-required")&&t.push(a.getAttribute("data-internal-id"))}),this.requiredFieldsArr=e,this.wasRequiredFields=t}}var u={handleConditionalLogic(){!!window.hasOwnProperty("KaliFormConditionalLogic"+this.formId)&&new h(this,window["KaliFormConditionalLogic"+this.formId])}};class m{get computedValue(){let e=this.syntaxValue;return this.dependencies.map(t=>{switch(null!==t?t.getAttribute("type"):""){case"file":var a=t.getAttribute("data-uploaded-file");e=e.replace("{".concat(t.getAttribute("data-name"),"}"),a);break;case"checkbox":var i=[];[...this.formProcessor.form.querySelectorAll('[name="'.concat(t.getAttribute("name"),'"]'))].map(e=>!!e.checked&&i.push(e.value));var n=i.join(",");e=e.replace("{".concat(t.getAttribute("name"),"}"),n);break;case"radio":var r="";[...this.formProcessor.form.querySelectorAll('[name="'.concat(t.getAttribute("name"),'"]'))].map(e=>!!e.checked&&(r=e.value)),e=e.replace("{".concat(t.getAttribute("name"),"}"),r);break;case"choices":let s=t.querySelectorAll("option:checked");n=Array.from(s).map(e=>e.value);e=e.replace("{".concat(t.getAttribute("name"),"}"),n);break;default:e=e.replace("{".concat(t.getAttribute("name"),"}"),t.value)}}),e}constructor(e){this.dependencies=[],this.specialDependency={},this.dependent=e.el,this.syntaxValue=e.el.getAttribute("value"),this.formProcessor=e.formProcessor,e.dependencies.map(e=>{let t=this.formProcessor.form.querySelector('[name="'.concat(e,'"]'));null===t||"radio"!==t.getAttribute("type")&&"checkbox"!==t.getAttribute("type")?null!==t&&this.dependencies.push(t):[...this.formProcessor.form.querySelectorAll('[name="'.concat(e,'"]'))].map(e=>this.dependencies.push(e))}),document.addEventListener("kaliFormUploadFieldInit",t=>{if(e.dependencies.indexOf(t.detail.name)>-1){var a=this.formProcessor.form.querySelector('[name="'.concat(t.detail.name,'"]'));null!==a&&(this.dependencies.push(a),this.specialDependency[t.detail.name]=t.detail.instance,a.setAttribute("data-name",t.detail.name),a.setAttribute("data-uploaded-file",""),this.setNewValue(),this.specialDependency[t.detail.name].on("processfile",(e,t)=>{wp.media.attachment(t.serverId).fetch().then(e=>{a.setAttribute("data-uploaded-file",wp.media.attachment(t.serverId).get("url")),this.setNewValue()})}),this.specialDependency[t.detail.name].on("removefile",()=>{a.setAttribute("data-uploaded-file",""),this.setNewValue()}))}}),this.setNewValue=this.setNewValue.bind(this),this.setNewValue(),this.dependencies.map(e=>{e.addEventListener("keyup",this.setNewValue,!1),e.addEventListener("change",this.setNewValue,!1)}),null!==this.dependent.nextSibling&&this.dependent.nextSibling.addEventListener("click",e=>{if(e.preventDefault(),"INPUT"===this.dependent.nodeName||"TEXTAREA"===this.dependent.nodeName)this.dependent.select(),document.execCommand("copy"),document.getSelection().removeAllRanges(),this.dependent.blur();else{const e=document.createElement("textarea");e.value=this.dependent.querySelector("code").innerText,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}})}setNewValue(){"DIV"===this.dependent.nodeName?this.dependent.querySelector("code").innerText=this.computedValue:this.dependent.value=this.computedValue}}var p={handleSmartTextOutput(){[...this.formElements].map(e=>{e.hasAttribute("smartoutput")&&e.hasAttribute("data-dependencies")&&new m({el:e,dependencies:e.getAttribute("data-dependencies").split(","),formProcessor:this})}),[...document.querySelectorAll("div[smartoutput]")].map(e=>{e.hasAttribute("data-dependencies")&&new m({el:e,dependencies:e.getAttribute("data-dependencies").split(","),formProcessor:this})})}};String.prototype.mapReplace=function(e){var t=[];for(var a in e)t.push(a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"));return this.replace(new RegExp(t.join("|"),"g"),(function(t){return e[t]}))};const f=window.kaliMath;class g{set equations(e){let t={},a={},i={};[...this.formProcessor.formElements].map(e=>{i[e.getAttribute("name")]=e.getAttribute("data-internal-id")}),Object.keys(e).map((e,t)=>{let i=e.replace(/\s/g,""),n=this.getEl(i);null!==n&&(a[n.getAttribute("data-internal-id")]=i)}),Object.keys(e).map((a,n)=>{let r=a.replace(/\s/g,""),s=void 0===i[r]?r:i[r];t[s]=e[a].mapReplace(i)}),this._equations=t}get equations(){return this._equations}getEl(e){return document.querySelector('[name="'.concat(e,'"]'))}_getParentNode(e){let t=this.getEl(e.field);if(null!==t)return t.closest('div[class^="col-"]')}_getValueFromUnknown(e,t){let a="checkbox"===t||"choices"===t?[]:"";switch(t){case"radio":a=this._getCheckedRadioItem(e);break;case"checkbox":a=this._getCheckedBoxes(e)}return a}_getValueFromChoices(e){let t=e.hasAttribute("multiple"),a=t?[]:"";return[...e.querySelectorAll("option")].map(e=>{t?a.push(isNaN(e.value)?this._tryToGetValueFromScope(e.value):e.value):a=isNaN(e.value)?this._tryToGetValueFromScope(e.value):e.value}),a}_getCheckedRadioItem(e){let t=e.length>=1?[...e]:[...document.getElementsByName(e.getAttribute("name"))];if(!t.length)return"";if(void 0===t.find(e=>e.checked))return"";let a=t.find(e=>e.checked).value;return a=isNaN(a)?this._tryToGetValueFromScope(a):a,a}_getCheckedBoxes(e){let t=e.length>=1?[...e]:[...document.getElementsByName(e.getAttribute("name"))];if(!t.length)return[];if(void 0===t.find(e=>e.checked))return[];let a=[];return t.map(e=>{if(e.checked){let t=isNaN(e.value)?this._tryToGetValueFromScope(e.value):e.value;a.push(t)}}),a}_tryToGetValueFromScope(e){let t=0;return this.scope.hasOwnProperty(e)&&(t=parseFloat(this.scope[e])),t}constructor(e,t){void 0!==f&&(this.formProcessor=e,this.eventBus=c.a,this.equations=t,this.evaluator=f.evaluate,this.solvedEquations={},this.createScope(),this.calculate(),this.attachEvents())}createScope(){this.scope={},[...this.formProcessor.formElements].map(e=>{let t=e.getAttribute("type"),a=e.getAttribute("data-internal-id");if(null!==a)switch(t){case"date":this.scope[a]=""===e.value?(new Date).getTime():new Date(e.value).getTime();break;case"range":case"text":case"number":this.scope[a]=isNaN(parseFloat(e.value))?0:parseFloat(e.value);break;case"checkbox":var i=document.getElementsByName(e.getAttribute("name")),n=0;[...i].map(e=>{e.checked&&(n+=e.value)}),this.scope[a]=isNaN(parseFloat(n))?0:parseFloat(n);break;case"radio":i=document.getElementsByName(e.getAttribute("name")),n=0;[...i].map(e=>{e.checked&&(n=e.value)}),this.scope[a]=isNaN(parseFloat(n))?0:parseFloat(n);break;case"dropdown":this.scope[a]=isNaN(parseFloat(e.value))?0:parseFloat(e.value);break;case"choices":n=0;var r=this._getValueFromChoices(e);if("string"==typeof r||!isNaN(r))return void(this.scope[a]=isNaN(parseFloat(r))?0:parseFloat(r));this.scope[a]=r.reduce((e,t)=>parseFloat(e)+parseFloat(t),0);break;case"textarea":n=0;if(""!==e.value&&isNaN(e.value))return void(this.scope[a]=e.value);this.scope[a]=n;break;default:this.scope[a]=0}})}calculate(){Object.keys(this.equations).map((e,t)=>{this.solvedEquations[e]=0;try{let t=this.evaluator(this.equations[e],this.scope),a=t instanceof f.Unit?this._returnUnitValue(t):this._returnValue(t);this.solvedEquations[e]=a,this.scope[e]=a}catch(t){console.warn("Something went wrong evaluating the following expression: "+this.equations[e])}}),this.calculationsFinished()}_returnUnitValue(e){return isNaN(e.value)&&(e.value=0),f.format(e,{number:"bigNumber",precision:e%1!=0?2:0,notation:"fixed"})}_returnValue(e){return Array.isArray(e)?e:isNaN(e)||e===1/0?f.format(0,{number:"bigNumber",notation:"fixed"}):f.format(e,{number:"bigNumber",precision:e%1!=0?2:0,notation:"fixed"})}calculationsFinished(){Object.keys(this.solvedEquations).map(e=>{let t=document.querySelector('[data-internal-id="'.concat(e,'"]'));null!==t&&(t.value=this.solvedEquations[e],t.dispatchEvent(new Event("change",{cancelable:!0})))})}attachEvents(){[...this.formProcessor.formElements].map(e=>{let t=e.getAttribute("data-internal-id");if("dateTimePicker"===e.getAttribute("data-kali-form-type")){let e=document.querySelector('[data-internal-id="'+t+'"]');return e.parentNode.classList.contains("flatpickr")&&(e=e.parentNode),void e._flatpickr.config.onChange.push(_.debounce(e=>{this.scope[t]=new Date(e).getTime(),_.debounce(this.calculate(),500)},200))}if("date"!==e.getAttribute("type"))if("choices"!==e.getAttribute("type"))if("dropdown"!==e.getAttribute("type")&&"range"!==e.getAttribute("type"))if("checkbox"!==e.getAttribute("type"))if("radio"!==e.getAttribute("type"))"number"!==e.getAttribute("type")?e.addEventListener("keyup",_.debounce(e=>{this.scope.hasOwnProperty(t)&&(this.scope[t]=isNaN(parseFloat(e.target.value))?0:parseFloat(e.target.value)),_.debounce(this.calculate(),500)},300)):((e,t,a)=>{t.split(" ").forEach(t=>e.addEventListener(t,a,!1))})(e,"change keyup mouseup",_.debounce(e=>{this.scope[t]=isNaN(parseFloat(e.target.value))?0:parseFloat(e.target.value),_.debounce(this.calculate(),500)}));else{a=document.getElementsByName(e.getAttribute("name"));[...a].map(e=>e.addEventListener("change",e=>{this.scope[t]=this._getCheckedRadioItem(a),_.debounce(this.calculate(),500)}))}else{var a=document.getElementsByName(e.getAttribute("name"));[...a].map(e=>e.addEventListener("change",e=>{var i=this._getCheckedBoxes(a);this.scope[t]=i.reduce((e,t)=>parseFloat(e)+parseFloat(t),0),_.debounce(this.calculate(),500)}))}else e.addEventListener("change",_.debounce(e=>{this.scope[t]=isNaN(parseFloat(e.target.value))?0:parseFloat(e.target.value),_.debounce(this.calculate(),500)}));else e.addEventListener("change",_.debounce(a=>{var i=this._getValueFromChoices(e);this.scope[t]="string"!=typeof i&&isNaN(i)?i.reduce((e,t)=>parseFloat(e)+parseFloat(t),0):isNaN(parseFloat(i))?0:parseFloat(i),_.debounce(this.calculate(),500)},200));else e.addEventListener("change",_.debounce(e=>{var a=e.target.value;this.scope[t]=new Date(a).getTime(),_.debounce(this.calculate(),500)},200))})}}var b={handleCalculator(){!!window.hasOwnProperty("KaliFormsEquations"+this.formId)&&new g(this,window["KaliFormsEquations"+this.formId])}};const v=window.kaliRating;var k={handleRatingFields(){void 0!==v&&[...this.formElements].map(e=>{if(e.classList.contains("kaliforms-rating")){let t=e.parentNode.querySelector("div.rating"),a=t.getAttribute("data-max-rating"),i=t.getAttribute("data-rating");jQuery(t).rating({initialRating:i,maxRating:a,onRate:t=>{e.value=t}})}})}},y={handleRangeFields(){let e=window.kaliRange;void 0!==e&&[...this.formElements].map(t=>{if("range"===t.getAttribute("type")){t.style.display="none";let a=t.nextSibling;parseFloat(t.value)>parseFloat(t.getAttribute("max"))&&(t.value=parseFloat(t.getAttribute("max")));let i={start:parseFloat(t.getAttribute("min")),tooltips:!0,step:parseFloat(t.getAttribute("step")),range:{min:parseFloat(t.getAttribute("min")),max:parseFloat(t.getAttribute("max"))}};t.hasAttribute("gradation")&&(a.classList.add("kali-margin"),i.pips={mode:"range",stepped:!0,density:5}),e.create(a,i),a.noUiSlider.set(t.value),a.noUiSlider.on("change",e=>{t.value=parseFloat(a.noUiSlider.get()),t.dispatchEvent(new Event("change",{cancelable:!0}))})}})}};a(359);document.addEventListener("kaliFormProcessConstructed",e=>{const t=e.detail;t.handleDateTimePicker=i.handleDateTimePicker.bind(t),t.handleChoices=r.handleChoices.bind(t),t.handlePageBreaks=l.handlePageBreaks.bind(t),t.handleConditionalLogic=u.handleConditionalLogic.bind(t),t.handleSmartTextOutput=p.handleSmartTextOutput.bind(t),t.handleRatingFields=k.handleRatingFields.bind(t),t.handleCalculator=b.handleCalculator.bind(t),t.handleRangeFields=y.handleRangeFields.bind(t),t.handleDateTimePicker(),t.handleChoices(),t.handlePageBreaks(),t.handleConditionalLogic(),t.handleSmartTextOutput(),t.handleRatingFields(),t.handleCalculator(),t.handleRangeFields()})},359:function(e,t){},4:function(e,t){const a={},i=function(){let e=0;return function(){return e+=1,e}}();e.exports={publish:function(e,t){a[e]&&Object.keys(a[e]).forEach(i=>a[e][i](t))},subscribe:function(e,t){const n=i();return a[e]||(a[e]={}),a[e][n]=t,{unsubscribe:()=>{delete a[e][n],0===Object.keys(a[e]).length&&delete a[e]}}},arrayUnique:function(e){return e.filter((function(t,a){return e.indexOf(t)>=a}))}}}});